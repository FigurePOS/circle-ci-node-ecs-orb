description: >
  terraform validate and scan for vulnerabilities

executor: node20

parameters:
  account_id:
    type: string
    description: "AWS Account ID"
  bucket_name:
    type: string
    description: "Name of S3 Bucket with terraform state"
    default: ""
  dir:
    type: string
    default: "tf"
    description: "Dir with terraform scripts"
  run_checkov:
    type: boolean
    default: true
    description: "Whether to run checkov security checks or not"

steps:
  - terraform_validate:
      account_id: << parameters.account_id >>
      bucket_name: <<parameters.bucket_name>>
      dir: << parameters.dir >>
      run_checkov: << parameters.run_checkov >>
